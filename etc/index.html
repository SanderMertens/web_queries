<html>
  <head>
    <title></title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/split-panes.css">
    <link rel="stylesheet" href="deps/TextareaDecorator.css">
    <link rel="icon" href="img/flecs_logo.png" />
  </head>
  <body>
    <!-- <script src="js/event_listener.js"></script> -->

    <div id="app">
      <!-- Top bar -->
      <div class="top-box">
        <div class="bar-group">
          <div class="play-button-box" v-tooltip="'Project repository'">
            <a href="https://github.com/SanderMertens/flecs" target="_blank">
              <img src="img/flecs_logo.png" alt="Flecs GitHub">
            </a>
          </div>
          <div>
            <connection-status 
              v-on:click="show_connection_modal"
              ref="connection_button" 
              :connection="connection" 
              :value="title"></connection-status>
          </div>
        </div>
        <div class="bar-group">
          <div class="share-button-box" ref="share_url_button" v-on:click="show_url_modal" v-tooltip="'Get link'">
            <icon-button :size="20" icon="feather:link" />
          </div>
          <div v-tooltip="'Report issue'">
            <a href="https://github.com/flecs-hub/explorer/issues" target="_blank" >
              <icon-button :size="20" icon="codicons:report" />
            </a>
          </div>
        </div>
      </div>

      <split-pane-container>

        <!-- Tree view -->
        <split-pane :fixed="true" :initial_width="220">
          <entity-tree ref="tree" 
            :valid="valid"
            :selected_entity="selected_entity"
            v-on:select="evt_entity_changed" 
            v-on:select_query="evt_select_query"/>
        </split-pane>

        <!-- Query results & Entity inspector -->
        <split-pane>
          <div class="query-box">
            <query :valid="valid" ref="query"
              v-on:select-entity="evt_follow_ref"/>
          </div>
        </split-pane>

        <!-- Editor -->
        <split-pane :fixed="true" :initial_width="400">

          <editor ref="plecs" v-if="!remote_mode"></editor>

          <inspector 
            :entity="entity_result"
            :entity_name="selected_entity"
            :valid="valid"
            v-on:select-entity="evt_follow_ref" 
            v-on:select-query="evt_select_query"
            ref="inspector"></inspector>
        </split-pane>
      </split-pane-container>

      <!-- Overlays -->
      <tooltip ref="tooltip"></tooltip>
      <url-popover 
        ref="share_url_popover"
        :url="url" 
        ></url-popover>
      <connection-popover 
        ref="connection_popover"
        :connection="connection"
        :host="host"
        ></connection-popover>
    </div>

    <!-- Webassembly module -->
    <script src="flecs_explorer.js"></script>
    <script src="flecs_explorer_imports.js"></script>

    <!-- Dependencies -->
    <script src="deps/vue.dev.js">
      Vue.config.devtools = true;
    </script>
    <script src="deps/Parser.js"></script>
    <script src="deps/SelectHelper.js"></script>
    <script src="deps/TextareaDecorator.js"></script>
    <script src="deps/Behave.js"></script> <!-- provides IDE-like behavior in text editor -->
    <script src="deps/floating-ui.core.min.js"></script>
    <script src="deps/floating-ui.dom.min.js"></script>
    <script src="deps/httpVueLoader.js"></script> <!-- loads Vue SFCs without webpack -->

    <script>
      var syntax_highlighter = new Parser(
        { whitespace: /\s+/,
          property: /[a-zA-Z_0-9]+(?=:)/,
          variable: /(\$[a-zA-Z_0-9]+)/,
          number: /\b[0-9e]+\b/,
          operator: /[(),{}\[\]=\.:?!]/,
          comment: /\/\/[^\r\n]*/,
          rel_prop: /\b(Transitive|Final|Reflexive|Tag|Exclusive|Symmetric|With|Acyclic|DontInherit)\b/,
          builtin: /\b(IsA|ChildOf|Component|Tag|Identifier|Name|Symbol|Prefab)\b/,
          module: /\b(Module)\b/,
          type: /\b(Struct|Enum|Bitmask|Primitive|Array|Vector)\b/,
          builtin_type: /\b(bool|byte|char|i8|i16|i32|i64|iptr|u8|u16|u32|u64|uptr|f32|f64|string|entity)\b/,
          builtin_literal: /\b(true|false|null)\b/,
          builtin_variable: /(\bThis\b)|[\\*]|[$]/,
          keyword: /\b(using|with)\b/,
          entity: /\b[a-zA-Z_0-9]+\b/,
          string: /"[^"]*"/,
          other: /\S/
        } );
    </script>

    <!-- Generic UI elements -->
    <script src="js/icon.js"></script>
    <script src="js/detail_toggle.js"></script>
    <script src="js/content_container.js"></script>
    <script src="js/split_panes.js"></script>

    <!-- Functional components -->
    <script src="js/functional_components/functional_icon.js"></script>
    <script src="js/functional_components/functional_icon_button.js"></script>
    <script src="js/functional_components/functional_entity_hierarchy.js"></script>

    <script src="js/status.js"></script>
    <script src="js/entity_icon.js"></script>
    <script src="js/entity_reference.js"></script>
    <script src="js/entity_parent.js"></script>
    <script src="js/entity_tree.js"></script>
    <script src="js/query.js"></script>
    <script src="js/query_editor.js"></script>
    <script src="js/query_results.js"></script>
    <script src="js/entity_inspector.js"></script>
    <script src="js/editor.js"></script>
    <script src="js/url_modal.js"></script>
    <script src="js/app_title.js"></script>
    <script src="js/app.js"></script>
  </body>
</html>
